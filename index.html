<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Gentle Rest</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Georgia", serif;
        background: #d7e2e8;
        min-height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 20px;
        overflow: hidden;
      }

      /* Language Toggle */
      .language-toggle {
        position: fixed;
        top: 30px;
        right: 30px;
        font-size: 0.9em;
        color: #6b7c8a;
        cursor: pointer;
        transition: color 0.3s ease;
        z-index: 1000;
      }

      .language-toggle:hover {
        color: #4a5568;
      }

      /* Title */
      h1 {
        position: fixed;
        top: 30px;
        left: 50%;
        transform: translateX(-50%);
        font-size: 2.2em;
        color: #4a5568;
        font-weight: 300;
        text-align: center;
      }

      /* Instructions */
      .instructions {
        position: fixed;
        bottom: 30px;
        left: 50%;
        transform: translateX(-50%);
        color: #8a9ba8;
        font-size: 0.9em;
        text-align: center;
        opacity: 0.7;
      }

      /* Container for carousel */
      .carousel-container {
        position: relative;
        width: 100%;
        max-width: 900px;
        height: 450px;
        display: flex;
        justify-content: center;
        align-items: center;
        perspective: 1200px;
      }

      /* Envelope carousel wrapper */
      .envelope-carousel {
        position: relative;
        width: 100%;
        height: 100%;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      /* Individual envelope card */
      .envelope-card {
        position: absolute;
        width: 420px;
        height: 280px;
        transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        cursor: pointer;
        transform-style: preserve-3d;
      }

      /* Center envelope - largest and in focus */
      .envelope-card.center {
        transform: translateX(0) scale(1.1) rotateY(0deg);
        z-index: 10;
        opacity: 1;
      }

      /* Left envelope */
      .envelope-card.left {
        transform: translateX(-380px) scale(0.85) rotateY(25deg);
        z-index: 5;
        opacity: 0.6;
      }

      /* Right envelope */
      .envelope-card.right {
        transform: translateX(380px) scale(0.85) rotateY(-25deg);
        z-index: 5;
        opacity: 0.6;
      }

      /* Far left */
      .envelope-card.far-left {
        transform: translateX(-650px) scale(0.6) rotateY(35deg);
        z-index: 1;
        opacity: 0.3;
      }

      /* Far right */
      .envelope-card.far-right {
        transform: translateX(650px) scale(0.6) rotateY(-35deg);
        z-index: 1;
        opacity: 0.3;
      }

      /* Hidden */
      .envelope-card.hidden {
        transform: translateX(0) scale(0.3);
        opacity: 0;
        pointer-events: none;
      }

      /* Envelope styling */
      .envelope {
        position: relative;
        width: 100%;
        height: 100%;
        transition: transform 0.3s ease;
      }

      .envelope:hover {
        transform: scale(1.05);
      }

      .envelope-body {
        position: absolute;
        width: 100%;
        height: 100%;
        background: #f5f0e8;
        border: 2px solid #d4c5b0;
        border-radius: 3px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
        z-index: 1;
      }

      .envelope-flap {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 50%;
        background: #ede5d8;
        border: 2px solid #d4c5b0;
        border-bottom: none;
        transform-origin: top center;
        transition: transform 0.8s ease;
        clip-path: polygon(0 0, 50% 60%, 100% 0);
        z-index: 10;
      }

      .envelope.opened .envelope-flap {
        transform: rotateX(180deg);
      }

      /* Wax seal */
      .wax-seal {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 65px;
        height: 65px;
        border-radius: 50%;
        z-index: 20;
        cursor: pointer;
        transition: all 0.3s ease;
        
        background: radial-gradient(
          circle at 35% 30%,
          #e87171 0%,
          #d65555 25%,
          #c94545 50%,
          #a83232 75%,
          #8b2525 100%
        );
        
        box-shadow: 
          0 5px 12px rgba(100, 30, 30, 0.5),
          inset 0 -3px 6px rgba(0, 0, 0, 0.35),
          inset 0 3px 4px rgba(255, 255, 255, 0.2),
          0 0 25px rgba(201, 69, 69, 0.25);
        
        background-image: 
          radial-gradient(
            circle at 35% 30%,
            #e87171 0%,
            #d65555 25%,
            #c94545 50%,
            #a83232 75%,
            #8b2525 100%
          ),
          repeating-radial-gradient(
            circle at 50% 50%,
            transparent 0,
            transparent 1.5px,
            rgba(0, 0, 0, 0.04) 1.5px,
            rgba(0, 0, 0, 0.04) 3px
          );
      }

      .wax-seal:hover {
        transform: translate(-50%, -50%) scale(1.1);
        box-shadow: 
          0 7px 16px rgba(100, 30, 30, 0.6),
          inset 0 -3px 6px rgba(0, 0, 0, 0.35),
          inset 0 3px 4px rgba(255, 255, 255, 0.2),
          0 0 30px rgba(201, 69, 69, 0.35);
      }

      .wax-seal::before {
        content: '';
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 16px;
        height: 16px;
        background: radial-gradient(
          circle,
          rgba(0, 0, 0, 0.3) 0%,
          rgba(0, 0, 0, 0.15) 50%,
          transparent 100%
        );
        border-radius: 50%;
        box-shadow: 
          inset 0 2px 3px rgba(0, 0, 0, 0.5),
          inset 0 -1px 2px rgba(255, 100, 100, 0.2),
          0 1px 1px rgba(255, 255, 255, 0.1);
      }

      .wax-seal::after {
        content: '✿';
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        color: rgba(0, 0, 0, 0.3);
        font-size: 40px;
        text-shadow: 
          0 2px 1px rgba(0, 0, 0, 0.3),
          0 -1px 0 rgba(255, 255, 255, 0.15),
          0 0 3px rgba(0, 0, 0, 0.2);
        z-index: 1;
      }

      .envelope.opened .wax-seal {
        opacity: 0;
        pointer-events: none;
        transition: opacity 0.5s ease;
      }

      /* Letter inside */
      .letter {
        position: absolute;
        top: 4%;
        left: 50%;
        transform: translate(-50%, 0);
        width: 92%;
        height: 250px;
        background: white;
        border: 1px solid #e8e8e8;
        border-radius: 3px;
        padding: 20px 30px;
        opacity: 0;
        pointer-events: none;
        transition: none;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
        z-index: 50;
        cursor: pointer;
        display: flex;
        justify-content: center;
        align-items: center;
        text-align: center;
        overflow: hidden;
      }

      .envelope.opened .letter {
        opacity: 1;
        pointer-events: auto;
        animation: popUpDown 1.4s ease-in-out forwards;
      }

      @keyframes popUpDown {
        0% {
          top: 4%;
          transform: translate(-50%, 0);
        }
        50% {
          top: -30%;
          transform: translate(-50%, 0);
        }
        100% {
          top: 4%;
          transform: translate(-50%, 0);
        }
      }

      /* Sparkles */
      .sparkles {
        position: absolute;
        inset: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        z-index: 0;
        opacity: 1;
        transition: opacity 0.5s ease;
      }

      .sparkles.hidden {
        opacity: 0;
      }

      .sparkle {
        position: absolute;
        font-size: 18px;
        opacity: 0;
        animation: twinkle 3s ease-in-out infinite;
        pointer-events: none;
      }

      .sparkle:nth-child(1) { top: 15%; left: 10%; animation-delay: 0s; }
      .sparkle:nth-child(2) { top: 25%; right: 15%; animation-delay: 0.5s; }
      .sparkle:nth-child(3) { top: 40%; left: 20%; animation-delay: 1s; }
      .sparkle:nth-child(4) { top: 50%; right: 10%; animation-delay: 1.5s; }
      .sparkle:nth-child(5) { top: 65%; left: 15%; animation-delay: 2s; }
      .sparkle:nth-child(6) { top: 75%; right: 20%; animation-delay: 2.5s; }
      .sparkle:nth-child(7) { top: 20%; left: 50%; animation-delay: 0.7s; }
      .sparkle:nth-child(8) { top: 60%; left: 50%; animation-delay: 1.7s; }
      .sparkle:nth-child(9) { top: 35%; left: 80%; animation-delay: 1.2s; }
      .sparkle:nth-child(10) { top: 80%; left: 40%; animation-delay: 2.2s; }

      @keyframes twinkle {
        0%, 100% {
          opacity: 0;
          transform: scale(0.3) rotate(0deg);
        }
        50% {
          opacity: 1;
          transform: scale(1) rotate(180deg);
        }
      }

      .glitter-wrapper {
        position: relative;
        z-index: 1;
      }

      /* Message text */
      .message-text {
        font-size: 1.1em;
        line-height: 1.8;
        color: #2d3748;
        text-align: center;
        filter: blur(8px);
        opacity: 0.3;
        transition: all 0.6s ease;
        cursor: pointer;
        max-width: 380px;
      }

      .letter.revealed .message-text {
        filter: blur(0);
        opacity: 1;
      }

      .chinese {
        font-family: "Microsoft YaHei", "PingFang SC", "SimHei", sans-serif;
      }

      /* Navigation arrows */
      .nav-arrow {
        position: fixed; /* Changed from absolute to fixed - stays at screen edge */
        top: 50%;
        transform: translateY(-50%);
        width: 50px;
        height: 50px;
        background: rgba(255, 255, 255, 0.3);
        border: 2px solid rgba(107, 124, 138, 0.3);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        z-index: 100;
        transition: all 0.3s ease;
        font-size: 24px;
        color: #6b7c8a;
        user-select: none;
      }

      .nav-arrow:hover {
        background: rgba(255, 255, 255, 0.5);
        border-color: rgba(107, 124, 138, 0.5);
        transform: translateY(-50%) scale(1.1);
      }

      .nav-arrow.left {
        left: 80px; /* Moved inward from 30px */
      }

      .nav-arrow.right {
        right: 80px; /* Moved inward from 30px */
      }

      /* Hide arrows when envelope is opened */
      .nav-arrow.hidden {
        opacity: 0;
        pointer-events: none;
      }
    </style>
  </head>
  <body>
    <h1>Gentle Rest</h1>

    <div class="language-toggle" id="languageToggle">切換中文</div>

    <!-- Navigation arrows - outside carousel container, at screen edges -->
    <div class="nav-arrow left" id="prevBtn">‹</div>
    <div class="nav-arrow right" id="nextBtn">›</div>

    <div class="carousel-container" id="carouselContainer">
      <!-- Envelope carousel -->
      <div class="envelope-carousel" id="envelopeCarousel">
        <!-- Envelopes will be generated here -->
      </div>
    </div>

    <div class="instructions" id="instructions">
      Swipe through envelopes and click the wax seal to open
    </div>

    <script>
      // ========= CONTEXT-FREE GRAMMAR =========
      class Grammar {
        constructor(rules) {
          this.rules = rules;
        }
        generate(symbol) {
          if (this.rules[symbol]) {
            const options = this.rules[symbol];
            const chosen = options[Math.floor(Math.random() * options.length)];
            return chosen
              .split(" ")
              .map((part) => {
                if (part.startsWith("<") && part.endsWith(">")) {
                  return this.generate(part);
                }
                return part;
              })
              .join(" ");
          }
          return symbol;
        }
        generateMessage() {
          return this.generate("<start>");
        }
      }

      const englishGrammar = new Grammar({
        "<start>": [
          "<validation> <permission>",
          "<validation> <rest>",
          "<permission> <rest>",
          "<validation> <permission> <rest>",
          "<you> <permission>",
          "<you> <rest>",
        ],
        "<validation>": [
          "You are doing enough today.",
          "Some days are harder than others.",
          "Your efforts matter, even when invisible.",
          "What you do is important.",
          "You are allowed to feel tired.",
          "Your feelings are valid.",
          "This work takes so much from you.",
        ],
        "<permission>": [
          "It is okay to rest.",
          "You can pause without guilt.",
          "Taking a break is not selfish.",
          "You are allowed to say no sometimes.",
          "Rest is not weakness.",
          "You deserve gentleness too.",
          "It is okay to ask for help.",
          "You do not have to be perfect.",
        ],
        "<rest>": [
          "Rest is part of the work.",
          "Small pauses count as care.",
          "Even five minutes matters.",
          "Rest helps you continue.",
          "Resting is not giving up.",
          "You can care for yourself while caring for others.",
          "Tomorrow you can try again.",
          "This moment of rest is yours.",
        ],
        "<you>": [
          "You are seen.",
          "You are not alone in this.",
          "You are doing your best.",
          "You matter.",
          "You are worthy of care.",
          "You are enough.",
        ],
      });

      const chineseGrammar = new Grammar({
        "<start>": [
          "<validation> <permission>",
          "<validation> <rest>",
          "<permission> <rest>",
          "<validation> <permission> <rest>",
          "<you> <permission>",
          "<you> <rest>",
        ],
        "<validation>": [
          "今天的你已經很努力了。",
          "有些日子就是比較難。",
          "你的付出很重要，即使沒有人看見。",
          "你做的事情很有意義。",
          "累了是正常的。",
          "你的感受是真實的。",
          "這份工作真的很辛苦。",
        ],
        "<permission>": [
          "休息是可以的。",
          "暫停不需要感到愧疚。",
          "休息不是自私。",
          "你可以偶爾說不。",
          "休息不是軟弱。",
          "你也值得被溫柔對待。",
          "尋求幫助是可以的。",
          "你不需要完美。",
        ],
        "<rest>": [
          "休息也是照顧的一部分。",
          "小小的暫停也算是照顧自己。",
          "就算只有五分鐘也很重要。",
          "休息讓你可以繼續下去。",
          "休息不是放棄。",
          "你可以在照顧別人的同時照顧自己。",
          "明天可以再試試看。",
          "這個休息的時刻屬於你。",
        ],
        "<you>": [
          "有人看見你的付出。",
          "你不是一個人。",
          "你已經盡力了。",
          "你很重要。",
          "你值得被照顧。",
          "你就是夠好的。",
        ],
      });

      let currentLanguage = "english";
      let currentGrammar = englishGrammar;
      let currentMessageParts = {
        validation: null,
        permission: null,
        rest: null,
        you: null
      };

      const languageToggle = document.getElementById("languageToggle");
      const instructions = document.getElementById("instructions");
      const carouselContainer = document.getElementById("carouselContainer");
      const envelopeCarousel = document.getElementById("envelopeCarousel");
      const prevBtn = document.getElementById("prevBtn");
      const nextBtn = document.getElementById("nextBtn");

      // Carousel state
      const NUM_ENVELOPES = 20;
      let currentIndex = 10; // Start in middle
      let envelopes = [];
      let envelopeMessages = [];
      let isEnvelopeOpened = false;

      // Timer variables
      let nextLetterTime = null;
      let countdownInterval = null;
      const FOUR_HOURS = 4 * 60 * 60 * 1000;

      // Pre-generate random messages for each envelope
      function generateEnvelopeMessages() {
        for (let i = 0; i < NUM_ENVELOPES; i++) {
          envelopeMessages.push({
            english: generateRandomMessage(englishGrammar),
            chinese: generateRandomMessage(chineseGrammar)
          });
        }
      }

      function generateRandomMessage(grammar) {
        const patterns = [
          ['validation', 'permission'],
          ['validation', 'rest'],
          ['permission', 'rest'],
          ['validation', 'permission', 'rest'],
          ['you', 'permission'],
          ['you', 'rest']
        ];
        const chosenPattern = patterns[Math.floor(Math.random() * patterns.length)];
        
        const parts = [];
        for (let partType of chosenPattern) {
          const options = grammar.rules['<' + partType + '>'];
          const index = Math.floor(Math.random() * options.length);
          parts.push(options[index]);
        }
        
        return parts.join(' ');
      }

      // Create envelopes
      function createEnvelopes() {
        for (let i = 0; i < NUM_ENVELOPES; i++) {
          const card = document.createElement('div');
          card.className = 'envelope-card';
          card.innerHTML = `
            <div class="envelope" data-index="${i}">
              <div class="envelope-body"></div>
              <div class="envelope-flap"></div>
              <div class="wax-seal"></div>
              <div class="letter">
                <div class="sparkles">
                  <span class="sparkle">✨</span>
                  <span class="sparkle">✨</span>
                  <span class="sparkle">✨</span>
                  <span class="sparkle">✨</span>
                  <span class="sparkle">✨</span>
                  <span class="sparkle">✨</span>
                  <span class="sparkle">✨</span>
                  <span class="sparkle">✨</span>
                  <span class="sparkle">✨</span>
                  <span class="sparkle">✨</span>
                </div>
                <div class="glitter-wrapper">
                  <p class="message-text">Click the wax seal to open</p>
                </div>
              </div>
            </div>
          `;
          
          envelopeCarousel.appendChild(card);
          envelopes.push(card);

          // Add click event to wax seal
          const waxSeal = card.querySelector('.wax-seal');
          const envelope = card.querySelector('.envelope');
          const letter = card.querySelector('.letter');
          const messageText = card.querySelector('.message-text');
          const sparkles = card.querySelector('.sparkles');

          waxSeal.addEventListener('click', (e) => {
            e.stopPropagation();
            if (parseInt(envelope.dataset.index) === currentIndex) {
              openEnvelope(envelope, letter, messageText, sparkles, i);
            }
          });

          // Click text to reveal
          messageText.addEventListener('click', (e) => {
            e.stopPropagation();
            letter.classList.add('revealed');
            sparkles.classList.add('hidden');
            initializeTimer();
          });
        }

        updateCarousel();
      }

      function updateCarousel() {
        envelopes.forEach((card, index) => {
          const diff = index - currentIndex;
          
          card.classList.remove('center', 'left', 'right', 'far-left', 'far-right', 'hidden');
          
          if (diff === 0) {
            card.classList.add('center');
          } else if (diff === -1) {
            card.classList.add('left');
          } else if (diff === 1) {
            card.classList.add('right');
          } else if (diff === -2) {
            card.classList.add('far-left');
          } else if (diff === 2) {
            card.classList.add('far-right');
          } else {
            card.classList.add('hidden');
          }
        });
      }

      function moveCarousel(direction) {
        if (isEnvelopeOpened) return;
        
        currentIndex += direction;
        
        // Loop around smoothly
        if (currentIndex < 0) currentIndex = NUM_ENVELOPES - 1;
        if (currentIndex >= NUM_ENVELOPES) currentIndex = 0;
        
        updateCarousel();
      }

      prevBtn.addEventListener('click', () => moveCarousel(-1));
      nextBtn.addEventListener('click', () => moveCarousel(1));

      // Keyboard navigation
      document.addEventListener('keydown', (e) => {
        if (e.key === 'ArrowLeft') moveCarousel(-1);
        if (e.key === 'ArrowRight') moveCarousel(1);
      });

      // Touch/swipe support
      let touchStartX = 0;
      let touchEndX = 0;

      carouselContainer.addEventListener('touchstart', (e) => {
        touchStartX = e.changedTouches[0].screenX;
      });

      carouselContainer.addEventListener('touchend', (e) => {
        touchEndX = e.changedTouches[0].screenX;
        handleSwipe();
      });

      function handleSwipe() {
        if (touchEndX < touchStartX - 50) moveCarousel(1);  // Swipe left
        if (touchEndX > touchStartX + 50) moveCarousel(-1); // Swipe right
      }

      function generateAndRememberMessage() {
        currentMessageParts = {
          validation: null,
          permission: null,
          rest: null,
          you: null
        };
        
        const patterns = [
          ['validation', 'permission'],
          ['validation', 'rest'],
          ['permission', 'rest'],
          ['validation', 'permission', 'rest'],
          ['you', 'permission'],
          ['you', 'rest']
        ];
        const chosenPattern = patterns[Math.floor(Math.random() * patterns.length)];
        
        const parts = [];
        for (let partType of chosenPattern) {
          const options = currentGrammar.rules['<' + partType + '>'];
          const index = Math.floor(Math.random() * options.length);
          currentMessageParts[partType] = index;
          parts.push(options[index]);
        }
        
        return parts.join(' ');
      }
      
      function translateCurrentMessage() {
        const parts = [];
        
        for (let partType in currentMessageParts) {
          const index = currentMessageParts[partType];
          if (index !== null) {
            const options = currentGrammar.rules['<' + partType + '>'];
            parts.push(options[index]);
          }
        }
        
        return parts.join(' ');
      }

      function openEnvelope(envelope, letter, messageText, sparkles, envelopeIndex) {
        if (isEnvelopeOpened) return;
        
        envelope.classList.add('opened');
        isEnvelopeOpened = true;
        
        // Hide arrows when envelope opens
        prevBtn.classList.add('hidden');
        nextBtn.classList.add('hidden');

        // Get the pre-generated message for THIS envelope
        const envelopeMessage = envelopeMessages[envelopeIndex];
        const message = currentLanguage === "english" ? envelopeMessage.english : envelopeMessage.chinese;
        
        messageText.textContent = message;
        messageText.dataset.envelopeIndex = envelopeIndex; // Remember which envelope this is

        if (currentLanguage === "chinese") {
          messageText.classList.add("chinese");
        } else {
          messageText.classList.remove("chinese");
        }

        setTimeout(() => {
          instructions.textContent = "Click the text to reveal the message";
        }, 800);
      }

      function toggleLanguage() {
        if (currentLanguage === "english") {
          currentLanguage = "chinese";
          currentGrammar = chineseGrammar;
          languageToggle.textContent = "Switch to English";
          instructions.textContent = "滑動選擇信封並點擊蠟封打開";
        } else {
          currentLanguage = "english";
          currentGrammar = englishGrammar;
          languageToggle.textContent = "切換中文";
          instructions.textContent = "Swipe through envelopes and click the wax seal to open";
        }

        if (isEnvelopeOpened) {
          const openedEnvelope = envelopes[currentIndex];
          const messageText = openedEnvelope.querySelector('.message-text');
          const envelopeIndex = parseInt(messageText.dataset.envelopeIndex);
          
          // Get the same message in the other language
          const envelopeMessage = envelopeMessages[envelopeIndex];
          const message = currentLanguage === "english" ? envelopeMessage.english : envelopeMessage.chinese;
          
          messageText.textContent = message;

          if (currentLanguage === "chinese") {
            messageText.classList.add("chinese");
            instructions.textContent = "點擊文字顯示訊息";
          } else {
            messageText.classList.remove("chinese");
            instructions.textContent = "Click the text to reveal the message";
          }
        }
      }

      // Timer functions
      function initializeTimer() {
        if (countdownInterval !== null) return;
        
        const stored = localStorage.getItem('nextLetterTime');
        if (stored) {
          nextLetterTime = parseInt(stored);
          if (Date.now() >= nextLetterTime) {
            setNextLetterTime();
          }
        } else {
          setNextLetterTime();
        }
        startCountdown();
      }

      function setNextLetterTime() {
        nextLetterTime = Date.now() + FOUR_HOURS;
        localStorage.setItem('nextLetterTime', nextLetterTime.toString());
      }

      function updateCountdown() {
        const now = Date.now();
        const remaining = nextLetterTime - now;

        if (remaining <= 0) {
          automaticNewLetter();
        }
      }

      function startCountdown() {
        updateCountdown();
        countdownInterval = setInterval(updateCountdown, 1000);
      }

      function automaticNewLetter() {
        // Reset all envelopes
        envelopes.forEach(card => {
          const envelope = card.querySelector('.envelope');
          const letter = card.querySelector('.letter');
          const sparkles = card.querySelector('.sparkles');
          
          envelope.classList.remove('opened');
          letter.classList.remove('revealed');
          sparkles.classList.remove('hidden');
        });

        isEnvelopeOpened = false;
        
        // Show arrows again
        prevBtn.classList.remove('hidden');
        nextBtn.classList.remove('hidden');

        if (currentLanguage === "english") {
          instructions.textContent = "Swipe through envelopes and click the wax seal to open";
        } else {
          instructions.textContent = "滑動選擇信封並點擊蠟封打開";
        }

        setNextLetterTime();
      }

      languageToggle.addEventListener("click", toggleLanguage);

      // Initialize
      generateEnvelopeMessages(); // Generate unique message for each envelope
      createEnvelopes();
    </script>
  </body>
</html>
